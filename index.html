<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A compilation of more than 40 functions designed to evaluate prediction performance of point-forecast models accounting for different aspects of the agreement between predicted and observed values. It includes error metrics (e.g. MAE, RMSE), model efficiencies (e.g. NSE, KGE), indices of agreement (e.g. d, RAC), goodness of fit (e.g. r, R2), concordance correlation (e.g. CCC), error decomposition (e.g. lack of accuracy-precision), and plots the visualize agreement. For more details visit the vignettes &lt;https://adriancorrendo.github.io/metrica/&gt;.">
<title>Prediction Performance Metrics • metrica</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Prediction Performance Metrics">
<meta property="og:description" content="A compilation of more than 40 functions designed to evaluate prediction performance of point-forecast models accounting for different aspects of the agreement between predicted and observed values. It includes error metrics (e.g. MAE, RMSE), model efficiencies (e.g. NSE, KGE), indices of agreement (e.g. d, RAC), goodness of fit (e.g. r, R2), concordance correlation (e.g. CCC), error decomposition (e.g. lack of accuracy-precision), and plots the visualize agreement. For more details visit the vignettes &lt;https://adriancorrendo.github.io/metrica/&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">metrica</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/available_metrics.html">Available prediction performance metrics and indices</a>
    <a class="dropdown-item" href="articles/vignette1.html">Assessing model agreement in wheat grain nitrogen content prediction - a use case</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adriancorrendo/metrica/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="metrica-prediction-performance-metrics">metrica: Prediction performance metrics.<a class="anchor" aria-label="anchor" href="#metrica-prediction-performance-metrics"></a>
</h1></div>
<!-- badges: start -->
<p>The goal of the <em>metrica</em> package is to offer users of point-forecast models a toolbox with a wide spectrum of goodness of fit and error metrics (+40) accounting for different aspects of the agreement between predicted and observed values. Also, some basic visualization functions to assess models performance (e.g. scatter with regression line; Bland-Altman plot) are provided in customizable format (ggplot).</p>
<p><img src="reference/figures/metrica_logo.png" align="right" height="150" style="float:right; height:150px;"><br></p>
<p>This package contains +40 functions. Two arguments are always required: <code>observed</code>(Oi; a.k.a. actual, measured, truth, target) and <code>predicted</code> (Pi; a.k.a. simulated, fitted) values. Also, there is an optional <code>data</code> arg. that allows to call an existing data frame containing both observed and predicted vectors. <br></p>
<p>Some functions, also require to define axis <code>orientation</code>, such as the slope of linear regression describing the bivariate scatter. Current included functions cover the world of “regression error” metrics (i.e. prediction performance for continuous variables). Classification error metrics coming soon. <br></p>
<p>Always keep in mind that predicted values should come from out-of-bag samples (unseen by training set) to avoid overestimation of prediction performance. <br></p>
<p>Check the Documentation at <a href="https://adriancorrendo.github.io/metrica/" class="uri">https://adriancorrendo.github.io/metrica/</a> <br></p>
<p><strong>Vignettes</strong> <br></p>
<p><a href="https://adriancorrendo.github.io/metrica/articles/available_metrics.html">1. Complete list of metrics</a> <br></p>
<p><a href="https://adriancorrendo.github.io/metrica/articles/vignette1.html">2. A use case</a> <br></p>
<div class="section level2">
<h2 id="1-installation">1. Installation<a class="anchor" aria-label="anchor" href="#1-installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"adriancorrendo/metrica"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="2-native-datasets">2. Native datasets<a class="anchor" aria-label="anchor" href="#2-native-datasets"></a>
</h2>
<p>The <em>metrica</em> package comes with four example datasets from the APSIM software: <br> 1. <code>wheat</code>. 137 data-points of wheat grain N (grams per squared meter) <br> 2. <code>barley</code>. 69 data-points of barley grain number (x1000 grains per squared meter) <br> 3. <code>sorghum</code>. 36 data-points of sorghum grain number (x1000 grains per squared meter) <br> 4. <code>chickpea</code>. 39 data-points of chickpea aboveground dry mass (kg per hectare) <br></p>
<p>These data correspond to the latest, up-to-date, documentation and validation of version number 2020.03.27.4956. Data available at: <a href="https://doi.org/10.7910/DVN/EJS4M0" class="external-link uri">https://doi.org/10.7910/DVN/EJS4M0</a>. Further details can be found at the official APSIM Next Generation website: <a href="https://APSIMnextgeneration.netlify.app/modeldocumentation" class="external-link uri">https://APSIMnextgeneration.netlify.app/modeldocumentation</a> <br></p>
</div>
<div class="section level2">
<h2 id="3-example-code">3. Example Code<a class="anchor" aria-label="anchor" href="#3-example-code"></a>
</h2>
<p>This is a basic example which shows you the core functions of <em>metrica</em>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adriancorrendo.github.io/metrica/">metrica</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.r4photobiology.info/ggpmisc/" class="external-link">ggpmisc</a></span><span class="op">)</span>

<span class="co"># 1. A. Create a fake dataset</span>
<span class="co"># Set seed for reproducibility</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="co"># Create a random vector (X) with 100 values</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co"># Create a second vector (Y) with 100 values by adding error with respect</span>
<span class="co"># to the first vector (X).</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co"># Merge vectors in a data frame, rename them as synonyms of observed (measured) and predicted (simulated)</span>
<span class="va">example.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>measured <span class="op">=</span> <span class="va">X</span>, simulated <span class="op">=</span> <span class="va">Y</span><span class="op">)</span>

<span class="co"># 1. B. Or call native example datasets</span>

<span class="va">example.data</span> <span class="op">&lt;-</span> <span class="va">barley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># or 'wheat', 'sorghum', or 'chickpea'</span>
<span class="co"># 1.b. create columns as synonyms of observed (measured) and predicted (simulated)</span>
                <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>measured <span class="op">=</span> <span class="va">obs</span>, simulated <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>  


<span class="co"># 2. Use metrica plot functions</span>
<span class="co"># 2.a. Create scatter plot with PO orientation</span>
<span class="va">barley.scat.plot</span> <span class="op">&lt;-</span> <span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/scatter_plot.html">scatter_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example.data</span>, obs <span class="op">=</span> <span class="va">measured</span>, pred <span class="op">=</span> <span class="va">simulated</span>,
             orientation <span class="op">=</span> <span class="st">"PO"</span><span class="op">)</span>
<span class="va">barley.scat.plot</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Alternative using vectors instead of dataframe</span>
<span class="co">#metrica::scatter_plot(obs = example.data$obs, pred = example.data$pred)</span>

<span class="co"># 2.b. Create tiles plot with OP orientation</span>
<span class="va">barley.tiles.plot</span> <span class="op">&lt;-</span> <span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/tiles_plot.html">tiles_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example.data</span>, obs <span class="op">=</span> <span class="va">measured</span>, pred <span class="op">=</span> <span class="va">simulated</span>,
           bins <span class="op">=</span> <span class="fl">15</span>, orientation <span class="op">=</span> <span class="st">"OP"</span><span class="op">)</span>

<span class="va">barley.tiles.plot</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-2.png" width="100%"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2.c. Create a Bland-Altman plot</span>
<span class="va">barley.ba.plot</span> <span class="op">&lt;-</span> <span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/bland_altman_plot.html">bland_altman_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example.data</span>,
                           obs <span class="op">=</span> <span class="va">measured</span>, pred <span class="op">=</span> <span class="va">simulated</span><span class="op">)</span>

<span class="va">barley.ba.plot</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-3.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3. Get metrics estimates</span>
<span class="co"># 3.a. Single estimates</span>
<span class="co"># 3.a.i. Estimate coefficient of determination (R2)</span>

<span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/R2.html">R2</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example.data</span>, obs <span class="op">=</span> <span class="va">measured</span>, pred <span class="op">=</span> <span class="va">simulated</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.4512998</span>

<span class="co"># 3.a.ii. Estimate root mean squared error (RMSE)</span>
<span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/RMSE.html">RMSE</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example.data</span>, obs <span class="op">=</span> <span class="va">measured</span>, pred <span class="op">=</span> <span class="va">simulated</span><span class="op">)</span>
<span class="co">#&gt; [1] 3.986028</span>

<span class="co"># 3.a.iii. Estimate mean bias error (MBE)</span>
<span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/MBE.html">MBE</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example.data</span>, obs <span class="op">=</span> <span class="va">measured</span>, pred <span class="op">=</span> <span class="va">simulated</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.207378</span>

<span class="co"># 3.b. Metrics Summary </span>
<span class="va">metrics.sum</span> <span class="op">&lt;-</span> <span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/metrics_summary.html">metrics_summary</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example.data</span>, 
                                        obs <span class="op">=</span> <span class="va">measured</span>, pred <span class="op">=</span> <span class="va">simulated</span><span class="op">)</span>  
<span class="co"># Print first 15</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metrics.sum</span>, n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>
<span class="co">#&gt;    Metric      Score</span>
<span class="co">#&gt; 1      B0  1.1282743</span>
<span class="co">#&gt; 2      B1  0.9288715</span>
<span class="co">#&gt; 3       r  0.6717885</span>
<span class="co">#&gt; 4      R2  0.4512998</span>
<span class="co">#&gt; 5      Xa  0.9963915</span>
<span class="co">#&gt; 6     CCC  0.6693644</span>
<span class="co">#&gt; 7     MAE  3.0595501</span>
<span class="co">#&gt; 8    RMAE  0.1629325</span>
<span class="co">#&gt; 9    MAPE 16.8112673</span>
<span class="co">#&gt; 10  SMAPE 16.7848032</span>
<span class="co">#&gt; 11    RAE  0.7639151</span>
<span class="co">#&gt; 12    RSE  0.6164605</span>
<span class="co">#&gt; 13    MBE  0.2073780</span>
<span class="co">#&gt; 14    PBE  1.1043657</span>
<span class="co">#&gt; 15    PAB  0.2706729</span>

<span class="co"># Optional wrangling (WIDE)</span>
<span class="va">metrics.sum.wide</span> <span class="op">&lt;-</span> <span class="va">metrics.sum</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,
                      names_from <span class="op">=</span> <span class="st">"Metric"</span>,
                      values_from <span class="op">=</span> <span class="st">"Score"</span><span class="op">)</span> 

<span class="co"># 4. Test multiple datasets at once</span>
<span class="co"># 4.a. Create nested df with the native examples</span>
<span class="va">nested.examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>wheat <span class="op">=</span> <span class="fu">metrica</span><span class="fu">::</span><span class="va"><a href="reference/wheat.html">wheat</a></span>, 
                                  barley <span class="op">=</span> <span class="fu">metrica</span><span class="fu">::</span><span class="va"><a href="reference/barley.html">barley</a></span>,
                                  sorghum <span class="op">=</span> <span class="fu">metrica</span><span class="fu">::</span><span class="va"><a href="reference/sorghum.html">sorghum</a></span>, 
                                  chickpea <span class="op">=</span> <span class="fu">metrica</span><span class="fu">::</span><span class="va"><a href="reference/chickpea.html">chickpea</a></span><span class="op">)</span>, 
                             .id <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nested.examples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 2</span>
<span class="co">#&gt; # Groups:   id [4]</span>
<span class="co">#&gt;   id       data              </span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;list&gt;            </span>
<span class="co">#&gt; 1 barley   &lt;tibble [69 x 2]&gt; </span>
<span class="co">#&gt; 2 chickpea &lt;tibble [39 x 2]&gt; </span>
<span class="co">#&gt; 3 sorghum  &lt;tibble [36 x 2]&gt; </span>
<span class="co">#&gt; 4 wheat    &lt;tibble [137 x 2]&gt;</span>

<span class="co"># 4.b. Run </span>
<span class="va">multiple.sum</span> <span class="op">&lt;-</span> <span class="va">nested.examples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># Store metrics in new.column "performance"</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>performance <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/metrics_summary.html">metrics_summary</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">.</span>, obs <span class="op">=</span> <span class="va">obs</span>, pred <span class="op">=</span> <span class="va">pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">multiple.sum</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   id       data               performance  </span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;list&gt;             &lt;list&gt;       </span>
<span class="co">#&gt; 1 wheat    &lt;tibble [137 x 2]&gt; &lt;df [41 x 2]&gt;</span>
<span class="co">#&gt; 2 barley   &lt;tibble [69 x 2]&gt;  &lt;df [41 x 2]&gt;</span>
<span class="co">#&gt; 3 sorghum  &lt;tibble [36 x 2]&gt;  &lt;df [41 x 2]&gt;</span>
<span class="co">#&gt; 4 chickpea &lt;tibble [39 x 2]&gt;  &lt;df [41 x 2]&gt;</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="4-print-metrics-in-a-plot">4. Print metrics in a plot<a class="anchor" aria-label="anchor" href="#4-print-metrics-in-a-plot"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">metrica</span><span class="fu">::</span><span class="va"><a href="reference/wheat.html">wheat</a></span>

<span class="co"># B. Create list of selected metrics</span>
<span class="va">selected.metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MAE"</span>,<span class="st">"RMSE"</span>, <span class="st">"RRMSE"</span>, <span class="st">"R2"</span>, <span class="st">"CCC"</span>, <span class="st">"KGE"</span>, <span class="st">"PLA"</span>, <span class="st">"PLP"</span><span class="op">)</span>

<span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/scatter_plot.html">scatter_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, obs <span class="op">=</span> <span class="va">obs</span>, pred <span class="op">=</span> <span class="va">pred</span>, print_metrics <span class="op">=</span> <span class="cn">TRUE</span>, 
                      metrics_list <span class="op">=</span> <span class="va">selected.metrics</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="5-import-simulated-data-from-apsim-classic-out-and-apsim-nextgen-db">5. Import simulated data from APSIM Classic (.out) and APSIM NextGen (.db)<a class="anchor" aria-label="anchor" href="#5-import-simulated-data-from-apsim-classic-out-and-apsim-nextgen-db"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use import_apsim_out for APSIM Classic output</span>
<span class="va">soybean.out</span> <span class="op">&lt;-</span> <span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/import_apsim_out.html">import_apsim_out</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="st">"tests/testthat/examples/soybean.out"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">soybean.out</span><span class="op">)</span>
<span class="co">#&gt;   Date (dd/mm/yyyy) yield (kg/ha) biomass (kg/ha) grain_protein (%)</span>
<span class="co">#&gt; 1        16/05/2001        1449.8          2915.9            37.115</span>
<span class="co">#&gt; 2        10/05/2002        1092.5          2965.1            37.115</span>
<span class="co">#&gt; 3        23/04/2003        1368.9          3529.6            37.115</span>
<span class="co">#&gt; 4        26/04/2004        2121.6          4710.3            37.115</span>
<span class="co">#&gt; 5        09/05/2005        1950.3          4303.9            37.115</span>
<span class="co">#&gt; 6        20/04/2006        1670.6          3806.6            37.115</span>
<span class="co">#&gt;   GrainN (g/m^2) lai (m^2/m^2) oilGrainN (g/m^2) grain_oil_conc (%)</span>
<span class="co">#&gt; 1           0.00             0                 0                0.4</span>
<span class="co">#&gt; 2           7.10             0                 0                0.4</span>
<span class="co">#&gt; 3           8.90             0                 0                0.4</span>
<span class="co">#&gt; 4          13.79             0                 0                0.4</span>
<span class="co">#&gt; 5          12.68             0                 0                0.4</span>
<span class="co">#&gt; 6          10.86             0                 0                0.4</span>

<span class="co"># Use import_apsim_db for APSIM NextGeneration output</span>
<span class="va">soybean.db</span> <span class="op">&lt;-</span> <span class="fu">metrica</span><span class="fu">::</span><span class="fu"><a href="reference/import_apsim_db.html">import_apsim_db</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"soybean.example.db"</span>, folder <span class="op">=</span> <span class="st">"tests/testthat/examples/"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">soybean.db</span><span class="op">)</span>
<span class="co">#&gt;   CheckpointID SimulationID    Zone         Clock.Today Soybean.Phenology.Stage</span>
<span class="co">#&gt; 1            1            1 paddock 2018-01-01 12:00:00                       1</span>
<span class="co">#&gt; 2            1            1 paddock 2018-01-02 12:00:00                       1</span>
<span class="co">#&gt; 3            1            1 paddock 2018-01-03 12:00:00                       1</span>
<span class="co">#&gt; 4            1            1 paddock 2018-01-04 12:00:00                       1</span>
<span class="co">#&gt; 5            1            1 paddock 2018-01-05 12:00:00                       1</span>
<span class="co">#&gt; 6            1            1 paddock 2018-01-06 12:00:00                       1</span>
<span class="co">#&gt;   Soybean.Phenology.CurrentStageName Soybean.AboveGround.Wt Yield</span>
<span class="co">#&gt; 1                                                         0     0</span>
<span class="co">#&gt; 2                                                         0     0</span>
<span class="co">#&gt; 3                                                         0     0</span>
<span class="co">#&gt; 4                                                         0     0</span>
<span class="co">#&gt; 5                                                         0     0</span>
<span class="co">#&gt; 6                                                         0     0</span>
<span class="co">#&gt;   Soybean.Grain.Size Soybean.Grain.Number Soybean.Total.Wt Soybean.Leaf.FRGR</span>
<span class="co">#&gt; 1                  0                    0                0                 0</span>
<span class="co">#&gt; 2                  0                    0                0                 0</span>
<span class="co">#&gt; 3                  0                    0                0                 0</span>
<span class="co">#&gt; 4                  0                    0                0                 0</span>
<span class="co">#&gt; 5                  0                    0                0                 0</span>
<span class="co">#&gt; 6                  0                    0                0                 0</span>
<span class="co">#&gt;   Soybean.Leaf.Fw Soybean.Leaf.Photosynthesis.FT Soybean.Leaf.Photosynthesis.FW</span>
<span class="co">#&gt; 1               1                              0                              1</span>
<span class="co">#&gt; 2               1                              0                              1</span>
<span class="co">#&gt; 3               1                              0                              1</span>
<span class="co">#&gt; 4               1                              0                              1</span>
<span class="co">#&gt; 5               1                              0                              1</span>
<span class="co">#&gt; 6               1                              0                              1</span>
<span class="co">#&gt;   Soybean.WaterUptake(1) Soybean.WaterUptake(2) Soybean.WaterUptake(3)</span>
<span class="co">#&gt; 1                     NA                     NA                     NA</span>
<span class="co">#&gt; 2                     NA                     NA                     NA</span>
<span class="co">#&gt; 3                     NA                     NA                     NA</span>
<span class="co">#&gt; 4                     NA                     NA                     NA</span>
<span class="co">#&gt; 5                     NA                     NA                     NA</span>
<span class="co">#&gt; 6                     NA                     NA                     NA</span>
<span class="co">#&gt;   Soybean.WaterUptake(4) Soybean.WaterUptake(5) Soybean.WaterUptake(6)</span>
<span class="co">#&gt; 1                     NA                     NA                     NA</span>
<span class="co">#&gt; 2                     NA                     NA                     NA</span>
<span class="co">#&gt; 3                     NA                     NA                     NA</span>
<span class="co">#&gt; 4                     NA                     NA                     NA</span>
<span class="co">#&gt; 5                     NA                     NA                     NA</span>
<span class="co">#&gt; 6                     NA                     NA                     NA</span>
<span class="co">#&gt;   Soybean.WaterUptake(7) Soybean.WaterUptake(8) Soybean.WaterUptake(9)</span>
<span class="co">#&gt; 1                     NA                     NA                     NA</span>
<span class="co">#&gt; 2                     NA                     NA                     NA</span>
<span class="co">#&gt; 3                     NA                     NA                     NA</span>
<span class="co">#&gt; 4                     NA                     NA                     NA</span>
<span class="co">#&gt; 5                     NA                     NA                     NA</span>
<span class="co">#&gt; 6                     NA                     NA                     NA</span>
<span class="co">#&gt;   Soybean.WaterUptake(10)       Date</span>
<span class="co">#&gt; 1                      NA 2018-01-01</span>
<span class="co">#&gt; 2                      NA 2018-01-02</span>
<span class="co">#&gt; 3                      NA 2018-01-03</span>
<span class="co">#&gt; 4                      NA 2018-01-04</span>
<span class="co">#&gt; 5                      NA 2018-01-05</span>
<span class="co">#&gt; 6                      NA 2018-01-06</span>

<span class="co"># If observed.data is already as a dataframe, the user may do the match using a simple code like this:</span>
<span class="co"># PO.dataframe &lt;- simulated.data %&gt;% left_join(., observed.data) *by = "col" arg. could be required*</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/adriancorrendo/metrica/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/adriancorrendo/metrica/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing metrica</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Adrian A. Correndo <br><small class="roles"> Maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-4172-289X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Adrian A. Correndo <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-4172-289X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Luiz H. Moro Rosso <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-8642-911X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Rai Schwalbert <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8488-7507" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Carlos Hernandez <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0000-0000-0000" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Leonardo M. Bastos <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8958-6527" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Dean Holzworth <br><small class="roles"> Author </small>  </li>
<li>Ignacio A. Ciampitti <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9619-5129" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://ci.appveyor.com/project/adriancorrendo/metrica" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/adriancorrendo/metrica?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://github.com/adriancorrendo/metrica/actions" class="external-link"><img src="https://github.com/adriancorrendo/metrica/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/adriancorrendo/metrica" class="external-link"><img src="https://codecov.io/gh/adriancorrendo/metrica/branch/master/graph/badge.svg?token=CfK5NhXzYn" alt="codecov"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/414721777" class="external-link"><img src="https://zenodo.org/badge/414721777.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Adrian A. Correndo, Adrian A. Correndo, Luiz H. Moro Rosso, Rai Schwalbert, Carlos Hernandez, Leonardo M. Bastos, Dean Holzworth, Ignacio A. Ciampitti.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
