---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# metrica

<!-- badges: start -->
[![Travis build status](https://travis-ci.com/adriancorrendo/metrica.svg?branch=master)](https://app.travis-ci.com/github/adriancorrendo/metrica)
[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/adriancorrendo/metrica?branch=master&svg=true)](https://ci.appveyor.com/project/adriancorrendo/metrica)
[![Codecov test coverage](https://codecov.io/gh/adriancorrendo/metrica/branch/master/graph/badge.svg)](https://codecov.io/gh/adriancorrendo/metrica?branch=master)

<!-- badges: end -->

The goal of the *metrica* package is to offer users of point-forecast models a complete toolbox with error metrics accounting for different aspects of the agreement between predicted and observed values.

<img src="man/figures/metrica_logo.png" height="300" align="right"/>

## Installation

You can install the released version of metrica from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("metrica")
```

And the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("adriancorrendo/metrica")
```
## Example

This is a basic example which shows you core functions of *metrica*:

```{r example}
library(metrica)
# Seed for reproducibility
set.seed(1)
X <- rnorm(n = 100, mean = 0, sd = 10)
Y <- X + rnorm(n=100, mean = 0, sd = 3)

# Data frame
example.data <- data.frame(obs = X, pred = Y)

# Create scatter plot with OP orientation
metrica::scatter.plot(obs = example.data$obs, pred = example.data$pred,
             orientation = "OP")

# Create tiles plot with PO orientation
metrica::tiles.plot(obs = example.data$obs, pred = example.data$pred,
           bins = 15, orientation = "PO")

# Create a Bland-Altman plot
metrica::bland.altman.plot(example.data$obs, example.data$pred)

# Estimate coefficient of determination (R2)
metrica::R2(obs = example.data$obs, pred = example.data$pred)

# Estimate RMSE
metrica::RMSE(obs = example.data$obs, pred = example.data$pred)

# Estimate MBE
metrica::MBE(obs = example.data$obs, pred = example.data$pred)

# Estimate metrics summary
metrica::metrics.summary(obs = example.data$obs, pred = example.data$pred)

```
## Metrics available in *metrica*

The **metrica** package contains +40 functions . Most of them work with only two arguments: `observed`(a.k.a. actual, measured, truth, target) and `predicted` (a.k.a. simulated, fitted) values. For now, included functions cover the world of "regression error" metrics (i.e. prediction performance for continuous variables). Classification error metrics coming soon. <br/>


| #|Metric | Definition | Details | Formula |
| --|------- | ----------|-------------------- | -------------------- |
| 1| `B0` | Intercept of SMA regression | Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%5Cbeta_%7B0_%7BPO%7D%7D%20=%20%5Cbar%7BP%7D%20-%20%5Cfrac%7BS_P%7D%7BS_O%7D) or ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%5Cbeta_%7B0_%7BOP%7D%7D%20=%20%5Cbar%7BO%7D%20-%20%5Cfrac%7BS_O%7D%7BS_P%7D) |
| 2| `B1` | Slope of SMA regression |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%5Cbeta_%7B1_%7BPO%7D%7D%20=%20%5Cfrac%7BS_P%7D%7BS_O%7D) or ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%5Cbeta_%7B1_%7BOP%7D%7D%20=%20%5Cfrac%7BS_O%7D%7BS_P%7D)|
| 3| `r` | Pearson's correlation coefficient |  Strength of linear association between P and O. . However, it measures "precision" but no accuracy. | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20r%20=%20%5Cfrac%7B%7BS%7D_%7BPO%7D%7D%7B%7BS%7D_%7BP%7D%7BS%7D_%7BO%7D%7D) |
| 4| `R2` | Coefficient of determination |  Strength of linear association between P and O. However, it measures "precision" but no accuracy | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20R%5E%7B2%7D%20=%20%5Cfrac%7B%7BS%5E2%7D_%7BPO%7D%7D%7B%7BS%5E2%7D_%7BP%7D%7BS%5E2%7D_%7BO%7D%7D)|
| 5| `Xa` | Accuracy coefficient | Measures accuracy. Used to adjust the precision measured by `r` to estimate agreement |![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20X_a%20=%20%5Cfrac%7B2%7D%7B%5Cfrac%7BS_P%7D%7BS_O%7D%20&plus;%20%5Cfrac%7BS_O%7D%7BS_P%7D%20&plus;%20%5Cfrac%7B(%5Cbar%7BO%7D-%5Cbar%7BP%7D)%5E2%7D%7BS_O%20S_P%7D%7D) |
| 6| `CCC` | Concordance correlation coefficient | Tests agreement. It presents both precision (r) and accuracy (Xa) components. Easy to interpret |![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20CCC%20=%20r%20*%20X_a)|
| 7| `MAE` | Mean Absolute Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20MAE%20=%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B%7CO_i%20-%20P_i%7C%7D)|
| 8| `RMAE` | Relative Mean Absolute Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20RMAE%20=%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B%7CO_i%20-%20P_i%7C%7D%7D%7B%5Cbar%7BO%7D%7D) |
| 9| `MAPE` | Mean Absolute Percentage Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20MAPE%20=%20%5Cfrac%7B1%7D%7Bn%7D%5Csum%7B%7C%5Cfrac%7BO_i-P_i%7D%7BO_i%7D%7C%7D) |
| 10| `SMAPE` | Symmetric Mean Absolute Percentage Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20SMAPE%20=%20%5Cfrac%7B1%7D%7Bn%7D%5Csum%7B%7C%5Cfrac%7B%7CO_i-P_i%7C%7D%7B(O_i&plus;P_i)/2%7D%7C%7D) |
| 11| `RAE` | Relative Absolute Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20RAE%20=%20%5Cfrac%7B%5Csum%7B%7CP_i-O_i%7C%7D%7D%7B%5Csum%7B%7CO_i-%5Cbar%7BO%7D%7C%7D%7D) |
| 12| `RSE` | Relative Squared Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20RSE%20=%20%5Cfrac%7B%5Csum%7B(P_i-O_i)%5E2%7D%7D%7B%5Csum%7B(O_i-%5Cbar%7BO%7D)%5E2%7D%7D) |
| 13| `MBE` | Mean Bias Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20MBE%20=%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(O_i%20-%20P_i)%7D%20=%20%5Cbar%7BO%7D-%5Cbar%7BP%7D) |
| 14| `PBE` | Percentage Bias Error |  Use | ![equation] |
| 14| `PAE` | Percentage Absolute Error |  Use | ![equation] |
| 15| `PAB` | Percentage Additive Bias |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20PAB%20=%20%5Cfrac%7B(%5Cbar%7BO%7D-%5Cbar%7BP%7D)%5E2%7D%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D%7D) |
| 16| `PPB` | Percentage Proportional Bias |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20PPB%20=%20%5Cfrac%7BS_O%20S_P%7D%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D%7D) |
| 17| `MSE` | Mean Squared Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20MSE%20=%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D) |
| 18| `RMSE` | Root Mean Squared Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20RMSE%20=%20%5Csqrt%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D%7D) |
| 19| `RRMSE` | Relative Root Mean Squared Error |  Use |![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20RRMSE%20=%20%5Cfrac%7B%5Csqrt%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D%7D%7D%7B%5Cbar%7BO%7D%7D) |
| 20| `RSR` | Root Mean Standard Deviation Ratio |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20RSR%20=%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D) |
| 21| `iqRMSE` | Inter-quartile Normalized Root Mean Squared Error |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20iqRMSE%20=%20%5Cfrac%7B%5Csqrt%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D%7D%7D%7B75%5E%7Bth%7D%20percentile%20-%2025%5E%7Bth%7D%20percentile%7D) |
| 22| `MLA` | Mean Lack of Accuracy. Correndo's MSE decomposition. Correndo et al. (2012) |  Use | ![equation] |
| 23| `MLP` | Mean Lack of Precision Correndo's MSE decomposition. Correndo et al. (2012) |  Use | ![equation] |
| 24| `PLA` | Percentage Lack of Accuracy |  Use | ![equation] |
| 25| `PLP` | Percentage Lack of Precision |  Use | ![equation] |
| 26| `MSEs` | Systematic MSE. Willmott's MSE decomposition. Willmott et al. (1985) |  Use | ![equation] |
| 27| `MSEu` | Unsystematic MSE. Willmott's MSE decomposition. Willmott et al. (1985) |  Use | ![equation] |
| 28| `SB` | Squared Bias |  Additive bias component, MSE decomposition. Kobayashi and Salam (2000) | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20SB%20=%20(%5Cbar%7BO%7D-%5Cbar%7BP%7D)%5E2) |
| 29| `SDSD` | Product of Standard Deviations | Proportional bias component,  MSE decomposition. Kobayashi and Salam (2000) | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%20SDSD%20=%20S_O%20S_P%20) |
| 30| `LCS` | Lack of Correlation  |  Random error component, MSE decomposition. Kobayashi and Salam (2000) | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%20LCS%20=%202%20S_P%20S_O%20(1-r)%20)|
| 31| `Ue` | Random error proportion of sum of squares|  Sum of squares decomposition. Theils' partial inequalities. Smith and Rose (1995) | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%20Ue%20=%20%5Cfrac%7B2n(1-r)S_O%20S_P%7D%7B%5Csum%7B(O_i-P_i)%5E2%7D%7D) |
| 32| `Uc` | Lack of Consistency |  Sum of squares decomposition. Theils' partial inequalities. Smith and Rose (1995) | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20Uc%20=%20%5Cfrac%7Bn(S_O-S_P)%5E2%7D%7B%5Csum%7B(O_i-P_i)%5E2%7D%7D) |
| 33| `Ub` | Proportional Bias error proportion. |  Sum of squares decomposition. Theils' partial inequalities. Smith and Rose (1995) | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20Ub%20=%20%5Cfrac%7Bn(%5Cbar%7BO%7D-%5Cbar%7BP%7D)%5E2%7D%7B%5Csum%7B(O_i-P_i)%5E2%7D%7D%20) |
| 34| `NSE` | Nash and Sutcliffe's Model Efficiency. Nash and Sutcliffe (1970) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20NSE%20=%201-%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(P_i%20-%20O_i)%5E2%7D%7D%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%7B(O_i%20-%20%5Cbar%7BO%7D)%5E2%7D%7D) |
| 35| `E1` | Absolute Model Efficiency. Legates and McCabes (1999) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20E1%20=%201-%20%5Cfrac%7B%5Csum%7B%7CP_i%20-%20O_i%7C%7D%7D%7B%5Csum%7B%7CO_i%20-%20%5Cbar%7BO%7D%7C%7D%7D) |
| 36| `Erel` | Relative Model Efficiency. Krause et al. (2005) |  Use |![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20Erel%20=%201-%20%5Cfrac%7B%5Csum%7B(%5Cfrac%7BP_i%20-%20O_i%7D%7BOi%7D)%5E2%7D%7D%7B%5Csum%7B(%5Cfrac%7BO_i%20-%20%5Cbar%7BO%7D%7D%7BOi%7D)%5E2%7D%7D) |
| 37| `KGE` | Kling-Gupta Model Efficiency. Kling et al. (2012) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20KGE%20=%201-%20%5Csqrt%7B(r-1)%5E2&plus;%20(%5Cfrac%7BS_P%7D%7BS_O%7D-1)%5E2&plus;(%5Cfrac%7B%5Cbar%7BP%7D%7D%7B%5Cbar%7BO%7D%7D-1)%5E2%7D) |
| 38| `d` | Index of Agreement. Willmott (1982) |  Use |  ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20d%20=%201-%20%5Cfrac%7B%5Csum%7B(O_i%20-%20P_i)%5E2%7D%7D%7B%5Csum%7B(%7CO_i%20-%20%5Cbar%7BP%7D%7C%20&plus;%20%7CP_i%20-%20%5Cbar%7BO%7D%7C%7D)%5E2%7D) |
| 39| `d1` | Modified Index of Agreement. Willmott et al. (1985) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20d1%20=%201-%20%5Cfrac%7B%5Csum%7B%7CO_i%20-%20P_i%7D%7C%7D%7B%5Csum%7B(%7CO_i%20-%20%5Cbar%7BO%7D%7C%20&plus;%20%7CP_i%20-%20%5Cbar%7BO%7D%7C%7D)%7D) |
| 40| `d1r` | Refined Index of Agreement. Willmott et al. (2012) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20d1r%20=%201-%20%5Cfrac%7B%5Csum%7B%7CO_i%20-%20P_i%7D%7C%7D%7B2%5Csum%7B%7CO_i%20-%20%5Cbar%7BO%7D%7C%7D%7D) |
| 41| `RAC` | Robinson's Agreement Coefficient. Robinson (1957) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20RAC%20=%201-%20%5Cfrac%7B%5Csum%7B(O_i%20-%20Z_i%7D)%5E2%20&plus;%20%5Csum%7B(P_i%20-%20Z_i%7D)%5E2%7D%7B%5Csum%7B(O_i%20-%20%5Cbar%7BZ%7D)%5E2%20&plus;%20%5Csum%7B(P_i%20-%20%5Cbar%7BZ%7D)%5E2%7D%20%7D%20%7D) where ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20Zi%20=%20%5Cfrac%7BO_i%20&plus;%20P_i%7D%7B2%7D;%20%5Cbar%7BZ%7D%20=%20%5Cbar%7BO%7D%20&plus;%20%5Cbar%7BP%7D) |
| 42| `AC` | Ji and Gallo's Agreement Coefficient. Ji and Gallo (2006) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20AC%20=%201%20-%20%5Cfrac%7B%5Csum%7B(O_i-P_i)%5E2%7D%7D%7B%5Csum%7B%5B(%7C%5Cbar%7BP%7D-%5Cbar%7BO%7D%7C&plus;%7CO_i-%5Cbar%7BO%7D%7C)(%7C%5Cbar%7BP%7D-%5Cbar%7BO%7D%7C&plus;%7CP_i-%5Cbar%7BP%7D%7C)%5D%7D%7D) |
| 43| `lambda` | Duveiller's Lambda Coefficient. Duveiller et al. (2015) |  Use | ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20%5Clambda%20=%201%20-%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bn%7D%5Csum(O_i-P_i)%5E2%7D%7BS%5E2_P&plus;S%5E2_O&plus;(%5Cbar%7BO%7D-%5Cbar%7BP%7D)%5E2&plus;k%7D) where ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20k%20=%200%5C,%5C,%20if%5C,%5C,%20r%20%5Cgeq%7B0%7D), otherwise ![equation](https://latex.codecogs.com/gif.image?%5Cdpi%7B300%7D%20%5Cbg_white%20k%20=%202%7C%5Csum%5B(O_i-%5Cbar%7BO%7D)(P_i-%5Cbar%7BP%7D)%5D%7C%20)|